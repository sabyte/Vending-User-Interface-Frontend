<html>
<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Payment with bKash</h1>
    <button id="bKash_button">Pay with bKash</button>

    <script>
$('#bKash_button').click(function () {
    $.ajax({
        url: 'https://backend-8duy.onrender.com/grant-token', // Updated backend URL
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({
            app_key: 'Pc0yKAFRbzf6N3yk9msFYs8Ttc',
            app_secret: 'LNHBzWWQliD4uLzxvSRNHFNFFUrIeCTptabBuNIPtAIfDKVEbK0c',
            username: '01619754538',
            password: '-2E8SmJIB{t'
        }),
        success: function (response) {
            let id_token = response.id_token;

            $.ajax({
                url: 'https://backend-8duy.onrender.com/create-payment', // Updated backend URL
                type: 'POST',
                contentType: 'application/json',
                headers: {
                    'Authorization': 'Bearer ' + id_token,
                    'X-App-Key': 'Pc0yKAFRbzf6N3yk9msFYs8Ttc'
                },
                data: JSON.stringify({
                    mode: '0011',
                    payerReference: '01723888888',
                    callbackURL: 'https://vending-user-interface-frontend.onrender.com',
                    merchantAssociationInfo: 'MI05MID54RF09123456One',
                    amount: '500',
                    currency: 'BDT',
                    intent: 'sale',
                    merchantInvoiceNumber: 'Inv0124'
                }),
                success: function (data) {
                    window.location.href = data.bkashURL;
                },
                error: function (xhr) {
                    alert('Failed to create payment. Please check the console for more details.');
                }
            });
        },
        error: function (xhr) {
            alert('Failed to get access token. Please check the console for more details.');
        }
    });
});
    </script>
</body>
</html>
